<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creative Studio - Eirene AI Wellness</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            /* Premium Color Palette */
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #f093fb;
            --accent-2: #f5576c;
            --accent-3: #4facfe;
            --success-color: #00d4aa;
            --warning-color: #ffb946;
            --error-color: #ff6b6b;
            
            /* Sophisticated Text Colors */
            --text-primary: #1a1a2e;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --text-light: #cbd5e0;
            
            /* Modern Background System */
            --bg-primary: #fafbfc;
            --bg-secondary: #f7f9fc;
            --bg-tertiary: #eef2f7;
            --bg-card: #ffffff;
            --bg-glass: rgba(255, 255, 255, 0.25);
            
            /* Border & Shadow System */
            --border-color: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --shadow-glow: 0 0 40px rgba(102, 126, 234, 0.15);
            
            /* Premium Gradients */
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-tertiary: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-success: linear-gradient(135deg, #00d4aa 0%, #01a085 100%);
            --gradient-glass: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.6) 100%);
            
            /* Modern Border Radius */
            --radius-xs: 8px;
            --radius-sm: 12px;
            --radius-md: 16px;
            --radius-lg: 24px;
            --radius-xl: 32px;
            --radius-full: 9999px;
        }

        [data-theme="dark"] {
            --text-primary: #f7fafc;
            --text-secondary: #e2e8f0;
            --text-muted: #a0aec0;
            --text-light: #718096;
            --bg-primary: #0f0f23;
            --bg-secondary: #16213e;
            --bg-tertiary: #1a2332;
            --bg-card: #1e2a3a;
            --bg-glass: rgba(30, 42, 58, 0.8);
            --border-color: #2d3748;
            --border-light: #4a5568;
            --shadow-glow: 0 0 40px rgba(102, 126, 234, 0.3);
        }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-x: hidden;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            position: relative;
        }

        /* Relaxing Background Animations */
        .wellness-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        .floating-orb {
            position: absolute;
            border-radius: 50%;
            opacity: 0.4;
            animation: gentleFloat 12s infinite ease-in-out;
        }

        .floating-orb:nth-child(1) {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.1), rgba(102, 126, 234, 0.02));
            top: 15%;
            left: 10%;
            animation-delay: 0s;
            animation-duration: 15s;
        }

        .floating-orb:nth-child(2) {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(240, 147, 251, 0.1), rgba(240, 147, 251, 0.02));
            top: 60%;
            right: 15%;
            animation-delay: -3s;
            animation-duration: 18s;
        }

        .floating-orb:nth-child(3) {
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(79, 172, 254, 0.08), rgba(79, 172, 254, 0.02));
            bottom: 25%;
            left: 70%;
            animation-delay: -7s;
            animation-duration: 20s;
        }

        .floating-orb:nth-child(4) {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, rgba(0, 212, 170, 0.1), rgba(0, 212, 170, 0.02));
            top: 35%;
            right: 40%;
            animation-delay: -5s;
            animation-duration: 16s;
        }

        @keyframes gentleFloat {
            0%, 100% { 
                transform: translateY(0px) translateX(0px) scale(1);
                opacity: 0.4;
            }
            25% { 
                transform: translateY(-20px) translateX(15px) scale(1.05);
                opacity: 0.6;
            }
            50% { 
                transform: translateY(-10px) translateX(-10px) scale(0.95);
                opacity: 0.3;
            }
            75% { 
                transform: translateY(-30px) translateX(20px) scale(1.02);
                opacity: 0.5;
            }
        }

        .zen-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                rgba(102, 126, 234, 0.02) 0%, 
                transparent 25%, 
                rgba(240, 147, 251, 0.02) 50%, 
                transparent 75%, 
                rgba(79, 172, 254, 0.02) 100%
            );
            animation: zenShift 12s ease-in-out infinite;
        }

        @keyframes zenShift {
            0%, 100% { opacity: 0.8; }
            33% { opacity: 0.4; }
            66% { opacity: 0.9; }
        }

        .selectable, input, textarea, .prompt-input, .story-content {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: var(--gradient-primary);
            z-index: 10000;
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .loading-screen.hide {
            opacity: 0;
            visibility: hidden;
            transform: scale(1.1);
        }

        .loader {
            width: 80px;
            height: 80px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            margin-bottom: 2rem;
        }

        .loading-text {
            color: white;
            font-size: 1.3rem;
            font-weight: 600;
            opacity: 0.95;
            animation: pulse 2s ease-in-out infinite;
            letter-spacing: 0.5px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.95; }
            50% { opacity: 0.7; }
        }

        .scroll-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            background: var(--gradient-primary);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            font-size: 1.2rem;
        }

        .scroll-top.show {
            opacity: 1;
            visibility: visible;
            animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .scroll-top:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: var(--shadow-xl);
        }

        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3) translateY(100px); }
            50% { opacity: 1; transform: scale(1.05) translateY(-10px); }
            70% { transform: scale(0.95) translateY(5px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        .header {
            background: var(--bg-glass);
            backdrop-filter: blur(30px) saturate(180%);
            border-bottom: 1px solid var(--border-light);
            padding: 1rem 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .header.scrolled {
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(40px) saturate(200%);
            padding: 0.8rem 0;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-full);
            background: var(--bg-card);
            box-shadow: var(--shadow-sm);
        }

        .logo:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .logo i {
            font-size: 2rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: rotate 4s ease-in-out infinite;
        }

        @keyframes rotate {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(10deg); }
        }

        .nav-center {
            display: flex;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            padding: 0.4rem;
            box-shadow: var(--shadow-sm);
            backdrop-filter: blur(20px);
        }

        .nav-links {
            display: flex;
            gap: 0.2rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 0.8rem 1.5rem;
            border-radius: var(--radius-full);
            position: relative;
            white-space: nowrap;
            font-size: 0.9rem;
            overflow: hidden;
        }

        .nav-links a.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .nav-links a:hover:not(.active) {
            background: var(--bg-secondary);
            color: var(--primary-color);
            transform: translateY(-1px);
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .profile-section {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.5rem 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
        }

        .profile-section:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .profile-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .profile-info {
            display: flex;
            flex-direction: column;
        }

        .profile-name {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .profile-status {
            font-size: 0.75rem;
            color: var(--success-color);
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--success-color);
            border-radius: 50%;
            animation: pulse-dot 2s ease-in-out infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }

        .theme-toggle {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            padding: 0.7rem;
            cursor: pointer;
            color: var(--text-primary);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-sm);
        }

        .theme-toggle:hover {
            background: var(--gradient-primary);
            color: white;
            transform: scale(1.1) rotate(10deg);
            box-shadow: var(--shadow-md);
        }

        .mobile-menu-btn {
            display: none;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            padding: 0.7rem;
            font-size: 1.1rem;
            color: var(--text-primary);
            cursor: pointer;
            width: 44px;
            height: 44px;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-sm);
        }

        /* Creative Studio Dashboard */
        .studio-dashboard {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
            padding-top: 120px;
            position: relative;
            z-index: 1;
        }

        /* Premium Welcome Section with 3D */
        .studio-header {
            background: var(--gradient-primary);
            color: white;
            padding: 4rem 3rem;
            border-radius: var(--radius-xl);
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-xl);
        }

        .studio-header::before {
            content: '';
            position: absolute;
            top: -30%;
            right: -15%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.15) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 10s ease-in-out infinite;
        }

        .studio-header::after {
            content: '';
            position: absolute;
            bottom: -20%;
            left: -10%;
            width: 250px;
            height: 250px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            border-radius: 50%;
            animation: float 8s ease-in-out infinite reverse;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-15px) rotate(120deg); }
            66% { transform: translateY(-8px) rotate(240deg); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
        }

        .hero-text {
            flex: 1;
        }

        .studio-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            animation: fadeInUp 1s cubic-bezier(0.4, 0, 0.2, 1) 0.2s both;
        }

        .studio-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            animation: fadeInUp 1s cubic-bezier(0.4, 0, 0.2, 1) 0.4s both;
        }

        .hero-visual {
            flex: 0 0 300px;
            height: 280px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 3D Creative Visualization Container */
        .three-creative-container {
            width: 100%;
            height: 100%;
            border-radius: var(--radius-lg);
            overflow: hidden;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: inset 0 0 30px rgba(255, 255, 255, 0.2);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .three-creative-container canvas {
            width: 100% !important;
            height: 100% !important;
            border-radius: var(--radius-lg);
        }

        /* Creative Tools */
        .creative-tools {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .tool-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 2.5rem;
            text-decoration: none;
            color: var(--text-primary);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
            cursor: pointer;
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) both;
        }

        .tool-card:nth-child(1) { animation-delay: 0.1s; }
        .tool-card:nth-child(2) { animation-delay: 0.2s; }
        .tool-card:nth-child(3) { animation-delay: 0.3s; }
        .tool-card:nth-child(4) { animation-delay: 0.4s; }

        .tool-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.03), rgba(118, 75, 162, 0.03));
            transition: all 0.4s ease;
        }

        .tool-card:hover::before {
            left: 0;
        }

        .tool-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
        }

        .tool-icon {
            width: 64px;
            height: 64px;
            background: var(--gradient-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            transition: all 0.4s ease;
        }

        .tool-card:hover .tool-icon {
            transform: scale(1.1) rotate(5deg);
            box-shadow: var(--shadow-glow);
        }

        .tool-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .tool-description {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }

        .tool-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.7rem 1.2rem;
            border-radius: var(--radius-full);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            border: none;
            box-shadow: var(--shadow-xs);
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-card);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }

        /* Creation Area */
        .creation-area {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 2.5rem;
            margin-bottom: 3rem;
            box-shadow: var(--shadow-sm);
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.5s both;
            display: none;
            transition: all 0.3s ease;
        }

        .creation-area.active {
            display: block;
        }

        .creation-area:hover {
            box-shadow: var(--shadow-md);
        }

        .creation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .creation-title {
            font-size: 1.4rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .creation-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-primary);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }

        .input-group {
            margin-bottom: 2rem;
        }

        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
        }

        .prompt-input {
            width: 100%;
            padding: 1rem 1.5rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--bg-card);
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
            box-shadow: var(--shadow-xs);
        }

        .prompt-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .emotion-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .emotion-btn {
            padding: 0.7rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            background: var(--bg-card);
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
            box-shadow: var(--shadow-xs);
        }

        .emotion-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            transform: translateY(-1px);
        }

        .emotion-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .ai-result {
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            padding: 2rem;
            margin-top: 2rem;
            border-left: 4px solid var(--primary-color);
            display: none;
            transition: all 0.3s ease;
        }

        .ai-result.show {
            display: block;
            animation: slideInUp 0.5s ease-out;
        }

        .ai-loading {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-secondary);
        }

        .ai-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Gallery Section */
        .gallery-section {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 2.5rem;
            box-shadow: var(--shadow-sm);
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.7s both;
            transition: all 0.3s ease;
        }

        .gallery-section:hover {
            box-shadow: var(--shadow-md);
        }

        .gallery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .gallery-title {
            font-size: 1.4rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .gallery-icon {
            width: 36px;
            height: 36px;
            background: var(--gradient-secondary);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .gallery-item {
            background: var(--bg-tertiary);
            border-radius: var(--radius-md);
            padding: 1.5rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            box-shadow: var(--shadow-xs);
            border: 1px solid var(--border-light);
        }

        .gallery-item:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-lg);
            background: var(--bg-card);
        }

        .gallery-preview {
            width: 100%;
            height: 150px;
            background: var(--gradient-primary);
            border-radius: var(--radius-sm);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            opacity: 0.8;
            transition: all 0.3s ease;
        }

        .gallery-item:hover .gallery-preview {
            opacity: 1;
            transform: scale(1.02);
        }

        .gallery-info h4 {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .gallery-info p {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        @keyframes slideInUp {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Tool-specific icon gradients */
        .tool-card:nth-child(1) .tool-icon { background: var(--gradient-secondary); }
        .tool-card:nth-child(2) .tool-icon { background: var(--gradient-success); }
        .tool-card:nth-child(3) .tool-icon { background: var(--gradient-tertiary); }
        .tool-card:nth-child(4) .tool-icon { background: linear-gradient(135deg, #ffb946 0%, #ff8a00 100%); }

        /* Mobile Responsive Design */
        @media (max-width: 968px) {
            .hero-content {
                flex-direction: column;
                text-align: center;
            }

            .hero-visual {
                flex: none;
                height: 250px;
            }
        }

        @media (max-width: 768px) {
            .nav-center {
                display: none;
            }

            .mobile-menu-btn {
                display: flex;
            }

            .profile-info {
                display: none;
            }

            .studio-dashboard {
                padding: 1rem;
                padding-top: 100px;
            }

            .studio-header {
                padding: 2rem;
                border-radius: var(--radius-lg);
            }

            .studio-title {
                font-size: 2rem;
            }

            .creative-tools {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .emotion-selector {
                grid-template-columns: repeat(2, 1fr);
            }

            .gallery-grid {
                grid-template-columns: 1fr;
            }

            .floating-orb {
                display: none;
            }

            .zen-overlay {
                opacity: 0.3;
            }
        }

        @media (max-width: 480px) {
            .nav-container {
                padding: 0 1rem;
            }

            .studio-header {
                padding: 1.5rem;
            }

            .hero-visual {
                height: 200px;
            }

            .tool-card {
                padding: 2rem;
            }

            .creation-area, .gallery-section {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Relaxing Background Animations -->
    <div class="wellness-background">
        <div class="floating-orb"></div>
        <div class="floating-orb"></div>
        <div class="floating-orb"></div>
        <div class="floating-orb"></div>
        <div class="zen-overlay"></div>
    </div>

    <!-- Enhanced Scroll Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Premium Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loader"></div>
        <div class="loading-text">Loading creative studio...</div>
    </div>

    <!-- Floating Scroll to Top Button -->
    <button class="scroll-top" id="scrollTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Modern Glass Header -->
    <header class="header" id="header">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <i class="fas fa-lotus"></i>
                Eirene
            </a>
            
            <div class="nav-center">
                <nav class="nav-links">
                    <a href="dashboard.html">Dashboard</a>
                    <a href="creative-studio.html" class="active">Creative Studio</a>
                    <a href="mood-tracker.html">Mood Tracker</a>
                    <a href="counselor.html">AI Counselor</a>
                    <a href="wellness-forecast.html">Wellness Forecast</a>
                    <a href="resources.html">Resources</a>
                </nav>
            </div>

            <div class="nav-right">
                <div class="profile-section" id="profileSection">
                    <div class="profile-avatar">P</div>
                    <div class="profile-info">
                        <div class="profile-name">Priya Sharma</div>
                        <div class="profile-status">
                            <div class="status-dot"></div>
                            Online
                        </div>
                    </div>
                </div>
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
            </div>

            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Creative Studio Dashboard -->
    <main class="studio-dashboard">
        <!-- Premium Welcome Section with 3D -->
        <section class="studio-header">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="studio-title">Creative Expression Studio</h1>
                    <p class="studio-subtitle">Transform your emotions into personalized art, music, and stories through AI-powered creative therapy</p>
                </div>
                <div class="hero-visual">
                    <div class="three-creative-container" id="threeCreativeContainer">
                        <!-- Three.js 3D creative visualization will render here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Modern Creative Tools -->
        <section class="creative-tools">
            <div class="tool-card" data-tool="art">
                <div class="tool-icon">
                    <i class="fas fa-palette"></i>
                </div>
                <h3 class="tool-title">AI Art Therapy</h3>
                <p class="tool-description">Create personalized visual art based on your current emotional state and therapeutic goals using Gemini AI.</p>
                <div class="tool-actions">
                    <button class="btn btn-primary" onclick="startArtGeneration()">
                        <i class="fas fa-paintbrush"></i>
                        Start Creating
                    </button>
                    <button class="btn btn-secondary">
                        <i class="fas fa-eye"></i>
                        View Gallery
                    </button>
                </div>
            </div>

            <div class="tool-card" data-tool="music">
                <div class="tool-icon">
                    <i class="fas fa-music"></i>
                </div>
                <h3 class="tool-title">Mood Music Composer</h3>
                <p class="tool-description">Generate custom instrumental music that matches and enhances your emotional journey with AI assistance.</p>
                <div class="tool-actions">
                    <button class="btn btn-primary" onclick="startMusicGeneration()">
                        <i class="fas fa-play"></i>
                        Compose Music
                    </button>
                    <button class="btn btn-secondary">
                        <i class="fas fa-headphones"></i>
                        Listen
                    </button>
                </div>
            </div>

            <div class="tool-card" data-tool="story">
                <div class="tool-icon">
                    <i class="fas fa-book"></i>
                </div>
                <h3 class="tool-title">Story Therapy</h3>
                <p class="tool-description">Co-create healing stories and visualize positive future scenarios with AI-powered narrative therapy.</p>
                <div class="tool-actions">
                    <button class="btn btn-primary" onclick="startStoryGeneration()">
                        <i class="fas fa-pen"></i>
                        Write Story
                    </button>
                    <button class="btn btn-secondary">
                        <i class="fas fa-book-open"></i>
                        Read Stories
                    </button>
                </div>
            </div>

            <div class="tool-card" data-tool="collab">
                <div class="tool-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3 class="tool-title">Creative Collaboration</h3>
                <p class="tool-description">Work with AI to remix negative thoughts into positive creative content and uplifting expressions.</p>
                <div class="tool-actions">
                    <button class="btn btn-primary" onclick="startCollaboration()">
                        <i class="fas fa-magic"></i>
                        Collaborate
                    </button>
                    <button class="btn btn-secondary">
                        <i class="fas fa-share"></i>
                        Share
                    </button>
                </div>
            </div>
        </section>

        <!-- Enhanced Creation Area -->
        <section class="creation-area" id="creationArea">
            <div class="creation-header">
                <div class="creation-title">
                    <div class="creation-icon" id="creationIcon">
                        <i class="fas fa-palette"></i>
                    </div>
                    <span id="creationTitleText">AI Art Therapy Session</span>
                </div>
                <button class="btn btn-secondary" onclick="closeCreation()">
                    <i class="fas fa-times"></i>
                    Close
                </button>
            </div>

            <div class="input-group">
                <label class="input-label">Describe your current emotions or thoughts:</label>
                <textarea class="prompt-input selectable" id="emotionInput" placeholder="I'm feeling overwhelmed with exam stress, but there's also hope for the future... Describe your feelings in detail for better AI understanding."></textarea>
            </div>

            <div class="input-group">
                <label class="input-label">Select your mood (helps AI understand context):</label>
                <div class="emotion-selector">
                    <button class="emotion-btn" data-emotion="peaceful">Peaceful</button>
                    <button class="emotion-btn" data-emotion="anxious">Anxious</button>
                    <button class="emotion-btn" data-emotion="hopeful">Hopeful</button>
                    <button class="emotion-btn" data-emotion="sad">Sad</button>
                    <button class="emotion-btn" data-emotion="excited">Excited</button>
                    <button class="emotion-btn" data-emotion="confused">Confused</button>
                </div>
            </div>

            <div class="tool-actions">
                <button class="btn btn-primary" id="generateBtn" onclick="generateContent()">
                    <i class="fas fa-magic"></i>
                    <span id="generateBtnText">Generate Art</span>
                </button>
                <button class="btn btn-secondary" onclick="saveDraft()">
                    <i class="fas fa-save"></i>
                    Save Draft
                </button>
            </div>

            <!-- AI Generation Results -->
            <div class="ai-result" id="aiResult">
                <div class="ai-loading" id="aiLoading">
                    <div class="ai-spinner"></div>
                    <span>AI is creating your personalized content...</span>
                </div>
                <div id="aiContent" style="display: none;">
                    <!-- Generated content will appear here -->
                </div>
            </div>
        </section>

        <!-- Premium Gallery Section -->
        <section class="gallery-section">
            <div class="gallery-header">
                <div class="gallery-title">
                    <div class="gallery-icon">
                        <i class="fas fa-images"></i>
                    </div>
                    Your Creative Journey
                </div>
                <button class="btn btn-secondary">
                    <i class="fas fa-download"></i>
                    Export All
                </button>
            </div>

            <div class="gallery-grid">
                <div class="gallery-item">
                    <div class="gallery-preview">
                        <i class="fas fa-palette"></i>
                    </div>
                    <div class="gallery-info">
                        <h4>Peaceful Morning</h4>
                        <p>Abstract art • Created 2 hours ago</p>
                    </div>
                </div>

                <div class="gallery-item">
                    <div class="gallery-preview">
                        <i class="fas fa-music"></i>
                    </div>
                    <div class="gallery-info">
                        <h4>Calming Waves</h4>
                        <p>Ambient music • Created yesterday</p>
                    </div>
                </div>

                <div class="gallery-item">
                    <div class="gallery-preview">
                        <i class="fas fa-book"></i>
                    </div>
                    <div class="gallery-info">
                        <h4>Future Dreams</h4>
                        <p>Healing story • Created 3 days ago</p>
                    </div>
                </div>

                <div class="gallery-item">
                    <div class="gallery-preview">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="gallery-info">
                        <h4>Self-Love Journey</h4>
                        <p>Collaborative piece • Created 1 week ago</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Three.js Local File -->
    <script src="./three.js"></script>

    <script>
        // Global Three.js Variables for Creative Visualization
        let scene, camera, renderer, creativeSphere, artParticles, musicWaves;
        let mouseX = 0, mouseY = 0;
        let targetRotationX = 0, targetRotationY = 0;
        let isThreeInitialized = false;

        // Global variables for current creation type
        let currentCreationType = 'art';
        let selectedEmotion = '';

        // GEMINI API CONFIGURATION
        const GEMINI_API_KEY = 'YOUR_GEMINI_API_KEY_HERE';
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent';

        // Enhanced Loading Screen
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hide');
                init3DCreativeVisualization();
            }, 2000);
        });

        // Initialize Three.js 3D Creative Visualization
        function init3DCreativeVisualization() {
            console.log('Starting 3D creative visualization...');
            
            if (typeof THREE === 'undefined') {
                console.error('THREE.js not loaded! Using fallback...');
                showCreativeFallback();
                return;
            }
            
            const container = document.getElementById('threeCreativeContainer');
            if (!container) {
                console.error('Container not found!');
                return;
            }
            
            try {
                // Scene setup
                scene = new THREE.Scene();
                
                // Camera setup
                const containerWidth = container.clientWidth || 300;
                const containerHeight = container.clientHeight || 280;
                
                camera = new THREE.PerspectiveCamera(
                    70, 
                    containerWidth / containerHeight, 
                    0.1, 
                    100
                );
                camera.position.z = 4;
                
                // Renderer setup
                renderer = new THREE.WebGLRenderer({ 
                    antialias: true, 
                    alpha: true,
                    powerPreference: "high-performance"
                });
                
                renderer.setSize(containerWidth, containerHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                renderer.setClearColor(0x000000, 0);
                
                container.innerHTML = '';
                container.appendChild(renderer.domElement);
                
                console.log('3D Creative renderer created');

                // Creative Lighting - Artistic and Inspiring
                const ambientLight = new THREE.AmbientLight(0xf093fb, 0.6);
                scene.add(ambientLight);

                const directionalLight1 = new THREE.DirectionalLight(0x667eea, 1.2);
                directionalLight1.position.set(5, 5, 5);
                scene.add(directionalLight1);

                const pointLight1 = new THREE.PointLight(0x4facfe, 0.8, 12);
                pointLight1.position.set(-4, 3, 2);
                scene.add(pointLight1);

                const pointLight2 = new THREE.PointLight(0x00d4aa, 0.6, 8);
                pointLight2.position.set(3, -3, 4);
                scene.add(pointLight2);

                // Main Creative Sphere - Dynamic and Artistic
                createCreativeVisualization();

                // Add Artistic Particles
                createArtisticParticles();

                // Mouse interaction
                container.addEventListener('mousemove', onCreativeMouseMove, false);
                container.addEventListener('mouseleave', onCreativeMouseLeave, false);

                // Resize handler
                window.addEventListener('resize', onCreativeWindowResize, false);

                // Mark as initialized and start animation
                isThreeInitialized = true;
                animate3DCreative();
                
                console.log('3D creative visualization initialized successfully!');
                
            } catch (error) {
                console.error('Three.js creative visualization error:', error);
                showCreativeFallback();
            }
        }

        function createCreativeVisualization() {
            // Central Creative Sphere with dynamic materials
            const sphereGeometry = new THREE.SphereGeometry(1.0, 32, 32);
            
            // Create an artistic material that changes with creativity
            const sphereMaterial = new THREE.MeshStandardMaterial({
                color: 0xf093fb,
                metalness: 0.9,
                roughness: 0.1,
                emissive: 0x332244,
                emissiveIntensity: 0.4,
                transparent: true,
                opacity: 0.85
            });

            creativeSphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
            scene.add(creativeSphere);

            // Surrounding Creative Tools (Art, Music, Story, Collab)
            const creativeTools = [
                { color: 0xf093fb, position: { x: 2.2, y: 0, z: 0 }, type: 'art' },      // Art - Pink
                { color: 0x00d4aa, position: { x: -2.2, y: 0, z: 0 }, type: 'music' },   // Music - Green
                { color: 0x4facfe, position: { x: 0, y: 2.2, z: 0 }, type: 'story' },    // Story - Blue
                { color: 0xffb946, position: { x: 0, y: -2.2, z: 0 }, type: 'collab' }   // Collab - Orange
            ];

            creativeTools.forEach((tool, index) => {
                // Create different shapes for different tools
                let geometry;
                switch(tool.type) {
                    case 'art':
                        geometry = new THREE.OctahedronGeometry(0.4);
                        break;
                    case 'music':
                        geometry = new THREE.TetrahedronGeometry(0.4);
                        break;
                    case 'story':
                        geometry = new THREE.BoxGeometry(0.6, 0.6, 0.6);
                        break;
                    case 'collab':
                        geometry = new THREE.DodecahedronGeometry(0.4);
                        break;
                }

                const toolMaterial = new THREE.MeshStandardMaterial({
                    color: tool.color,
                    metalness: 0.7,
                    roughness: 0.3,
                    transparent: true,
                    opacity: 0.8,
                    emissive: tool.color,
                    emissiveIntensity: 0.1
                });

                const toolMesh = new THREE.Mesh(geometry, toolMaterial);
                toolMesh.position.set(
                    tool.position.x,
                    tool.position.y,
                    tool.position.z
                );

                scene.add(toolMesh);

                // Store reference for animation
                creativeSphere[`tool_${index}`] = toolMesh;

                // Creative connection lines (flowing energy)
                const points = [];
                points.push(new THREE.Vector3(0, 0, 0));
                points.push(new THREE.Vector3(
                    tool.position.x,
                    tool.position.y,
                    tool.position.z
                ));

                const lineGeometry = new THREE.BufferGeometry().setFromPoints(points);
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: tool.color,
                    transparent: true,
                    opacity: 0.4,
                    linewidth: 2
                });

                const line = new THREE.Line(lineGeometry, lineMaterial);
                scene.add(line);

                // Store line reference for animation
                creativeSphere[`line_${index}`] = line;
            });

            console.log('Creative visualization shapes created');
        }

        function createArtisticParticles() {
            if (!scene) return;
            
            try {
                const particleCount = 100;
                const particlesGeometry = new THREE.BufferGeometry();
                const positions = new Float32Array(particleCount * 3);
                const colors = new Float32Array(particleCount * 3);
                const sizes = new Float32Array(particleCount);
                
                for (let i = 0; i < particleCount; i++) {
                    // Create artistic particle distribution
                    const radius = 3 + Math.random() * 2.5;
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.random() * Math.PI;
                    
                    positions[i * 3] = radius * Math.sin(phi) * Math.cos(theta);
                    positions[i * 3 + 1] = radius * Math.sin(phi) * Math.sin(theta);
                    positions[i * 3 + 2] = radius * Math.cos(phi);
                    
                    // Artistic color palette
                    const colorVariation = Math.random();
                    if (colorVariation < 0.25) {
                        // Pink - Art
                        colors[i * 3] = 0.9 + Math.random() * 0.1;     // R
                        colors[i * 3 + 1] = 0.3 + Math.random() * 0.3; // G  
                        colors[i * 3 + 2] = 0.8 + Math.random() * 0.2; // B
                    } else if (colorVariation < 0.5) {
                        // Blue - Stories
                        colors[i * 3] = 0.2 + Math.random() * 0.3;     // R
                        colors[i * 3 + 1] = 0.6 + Math.random() * 0.2; // G
                        colors[i * 3 + 2] = 0.9 + Math.random() * 0.1; // B
                    } else if (colorVariation < 0.75) {
                        // Green - Music
                        colors[i * 3] = 0.0 + Math.random() * 0.2;     // R
                        colors[i * 3 + 1] = 0.8 + Math.random() * 0.2; // G
                        colors[i * 3 + 2] = 0.6 + Math.random() * 0.3; // B
                    } else {
                        // Orange - Collaboration
                        colors[i * 3] = 1.0;                           // R
                        colors[i * 3 + 1] = 0.6 + Math.random() * 0.3; // G
                        colors[i * 3 + 2] = 0.2 + Math.random() * 0.3; // B
                    }
                    
                    sizes[i] = Math.random() * 0.05 + 0.02;
                }
                
                particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
                particlesGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));
                
                const particlesMaterial = new THREE.PointsMaterial({
                    size: 0.04,
                    transparent: true,
                    opacity: 0.8,
                    vertexColors: true,
                    blending: THREE.AdditiveBlending,
                    sizeAttenuation: true
                });
                
                artParticles = new THREE.Points(particlesGeometry, particlesMaterial);
                scene.add(artParticles);
                
                console.log('Artistic particles added');
            } catch (error) {
                console.error('Error creating artistic particles:', error);
            }
        }

        function onCreativeMouseMove(event) {
            if (!isThreeInitialized) return;
            
            const container = document.getElementById('threeCreativeContainer');
            const rect = container.getBoundingClientRect();
            
            mouseX = ((event.clientX - rect.left) / container.clientWidth) * 2 - 1;
            mouseY = -((event.clientY - rect.top) / container.clientHeight) * 2 + 1;
            
            targetRotationX = mouseY * 0.4;
            targetRotationY = mouseX * 0.4;
        }

        function onCreativeMouseLeave() {
            targetRotationX = 0;
            targetRotationY = 0;
        }

        function onCreativeWindowResize() {
            if (!isThreeInitialized) return;
            
            const container = document.getElementById('threeCreativeContainer');
            if (!container || !camera || !renderer) return;
            
            const containerWidth = container.clientWidth || 300;
            const containerHeight = container.clientHeight || 280;
            
            camera.aspect = containerWidth / containerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(containerWidth, containerHeight);
        }

        function animate3DCreative() {
            if (!isThreeInitialized) return;
            
            requestAnimationFrame(animate3DCreative);

            try {
                if (creativeSphere) {
                    // Interactive rotation
                    creativeSphere.rotation.x += (targetRotationX - creativeSphere.rotation.x) * 0.05;
                    creativeSphere.rotation.y += (targetRotationY - creativeSphere.rotation.y) * 0.05;
                    
                    // Creative pulsing and rotation
                    creativeSphere.rotation.x += 0.004;
                    creativeSphere.rotation.y += 0.006;
                    
                    // Creative pulsing based on creativity
                    const creativeScale = 1 + Math.sin(Date.now() * 0.003) * 0.15;
                    creativeSphere.scale.setScalar(creativeScale);
                    
                    // Animate creative tool shapes
                    const time = Date.now() * 0.001;
                    for (let i = 0; i < 4; i++) {
                        const toolMesh = creativeSphere[`tool_${i}`];
                        if (toolMesh) {
                            // Different rotation patterns for each tool
                            switch(i) {
                                case 0: // Art - Organic rotation
                                    toolMesh.rotation.x += 0.012;
                                    toolMesh.rotation.y += 0.008;
                                    break;
                                case 1: // Music - Rhythmic rotation
                                    toolMesh.rotation.x = Math.sin(time * 2) * 0.3;
                                    toolMesh.rotation.z += 0.015;
                                    break;
                                case 2: // Story - Page-like rotation
                                    toolMesh.rotation.y += 0.010;
                                    toolMesh.rotation.z = Math.cos(time * 1.5) * 0.2;
                                    break;
                                case 3: // Collaboration - Complex rotation
                                    toolMesh.rotation.x += 0.008;
                                    toolMesh.rotation.y += 0.012;
                                    toolMesh.rotation.z += 0.006;
                                    break;
                            }
                            
                            // Floating motion
                            const floatOffset = Math.sin(time * 2 + i) * 0.1;
                            const originalY = toolMesh.position.y > 0 ? 2.2 : -2.2;
                            const originalX = toolMesh.position.x > 0 ? 2.2 : toolMesh.position.x < 0 ? -2.2 : 0;
                            
                            if (originalY > 0 || originalY < 0) {
                                toolMesh.position.y = originalY + floatOffset * 0.3;
                            }
                            if (originalX !== 0) {
                                toolMesh.position.x = originalX + Math.cos(time + i) * 0.1;
                            }
                        }
                        
                        // Animate connection lines
                        const line = creativeSphere[`line_${i}`];
                        if (line) {
                            line.material.opacity = 0.3 + Math.sin(time * 3 + i) * 0.2;
                        }
                    }
                    
                    // Dynamic color changes based on creativity mode
                    updateCreativeSphereColor(currentCreationType);
                }

                if (artParticles) {
                    artParticles.rotation.y += 0.003;
                    artParticles.rotation.x += 0.001;
                    
                    // Creative particle movement
                    const positions = artParticles.geometry.attributes.position.array;
                    const time = Date.now() * 0.0005;
                    
                    for (let i = 0; i < positions.length; i += 3) {
                        const originalX = positions[i];
                        const originalY = positions[i + 1];
                        const originalZ = positions[i + 2];
                        
                        // Creative spiral movement
                        positions[i] += Math.sin(time * 2 + originalX) * 0.004;
                        positions[i + 1] += Math.cos(time * 1.5 + originalY) * 0.004;
                        positions[i + 2] += Math.sin(time + originalZ) * 0.003;
                    }
                    artParticles.geometry.attributes.position.needsUpdate = true;
                }

                if (renderer && scene && camera) {
                    renderer.render(scene, camera);
                }
            } catch (error) {
                console.error('3D creative animation error:', error);
                isThreeInitialized = false;
            }
        }

        function updateCreativeSphereColor(creativeType) {
            if (!creativeSphere) return;
            
            // Color mapping based on creative type
            let color, emissiveColor;
            
            switch(creativeType) {
                case 'art':
                    color = new THREE.Color().setHSL(0.85, 0.8, 0.6); // Pink/Purple
                    emissiveColor = new THREE.Color().setHSL(0.85, 0.6, 0.3);
                    break;
                case 'music':
                    color = new THREE.Color().setHSL(0.45, 0.8, 0.6); // Green
                    emissiveColor = new THREE.Color().setHSL(0.45, 0.6, 0.3);
                    break;
                case 'story':
                    color = new THREE.Color().setHSL(0.6, 0.8, 0.6); // Blue
                    emissiveColor = new THREE.Color().setHSL(0.6, 0.6, 0.3);
                    break;
                case 'collaboration':
                    color = new THREE.Color().setHSL(0.1, 0.8, 0.6); // Orange
                    emissiveColor = new THREE.Color().setHSL(0.1, 0.6, 0.3);
                    break;
                default:
                    color = new THREE.Color().setHSL(0.7, 0.7, 0.6); // Default purple
                    emissiveColor = new THREE.Color().setHSL(0.7, 0.5, 0.3);
            }
            
            creativeSphere.material.color = color;
            creativeSphere.material.emissive = emissiveColor;
        }

        // Fallback visualization if Three.js fails
        function showCreativeFallback() {
            const container = document.getElementById('threeCreativeContainer');
            if (!container) return;
            
            container.innerHTML = `
                <div style="
                    width: 100%;
                    height: 100%;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    background: linear-gradient(135deg, #f093fb, #f5576c);
                    border-radius: var(--radius-lg);
                    color: white;
                    text-align: center;
                ">
                    <div style="
                        width: 120px;
                        height: 120px;
                        background: rgba(255,255,255,0.2);
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 3rem;
                        margin-bottom: 1rem;
                        animation: gentleFloat 3s ease-in-out infinite;
                        border: 3px solid rgba(255,255,255,0.3);
                    ">
                        🎨
                    </div>
                    <div style="font-size: 1.1rem; font-weight: 600; opacity: 0.9;">
                        Creative Studio
                    </div>
                </div>
            `;
            
            console.log('Creative fallback visualization displayed');
        }

        // Tool Card Interactions - Updated for 3D integration
        function startArtGeneration() {
            currentCreationType = 'art';
            updateCreationArea('AI Art Therapy Session', 'fas fa-palette', 'Generate Art');
            showCreationArea();
            // Update 3D visualization color
            if (isThreeInitialized) {
                updateCreativeSphereColor('art');
            }
        }

        function startMusicGeneration() {
            currentCreationType = 'music';
            updateCreationArea('Mood Music Composer', 'fas fa-music', 'Compose Music');
            showCreationArea();
            if (isThreeInitialized) {
                updateCreativeSphereColor('music');
            }
        }

        function startStoryGeneration() {
            currentCreationType = 'story';
            updateCreationArea('Story Therapy Session', 'fas fa-book', 'Write Story');
            showCreationArea();
            if (isThreeInitialized) {
                updateCreativeSphereColor('story');
            }
        }

        function startCollaboration() {
            currentCreationType = 'collaboration';
            updateCreationArea('Creative Collaboration', 'fas fa-users', 'Start Collaboration');
            showCreationArea();
            if (isThreeInitialized) {
                updateCreativeSphereColor('collaboration');
            }
        }

        function updateCreationArea(title, icon, buttonText) {
            document.getElementById('creationTitleText').textContent = title;
            document.getElementById('creationIcon').innerHTML = `<i class="${icon}"></i>`;
            document.getElementById('generateBtnText').textContent = buttonText;
        }

        function showCreationArea() {
            document.getElementById('creationArea').classList.add('active');
            document.getElementById('creationArea').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }

        function closeCreation() {
            document.getElementById('creationArea').classList.remove('active');
            document.getElementById('aiResult').classList.remove('show');
            currentCreationType = 'art'; // Reset to default
            if (isThreeInitialized) {
                updateCreativeSphereColor('art');
            }
        }

        // Emotion Selector
        document.querySelectorAll('.emotion-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.emotion-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedEmotion = btn.getAttribute('data-emotion');
            });
        });

        // MAIN GEMINI API INTEGRATION FUNCTION
        async function generateContent() {
            const emotionInput = document.getElementById('emotionInput').value.trim();
            
            if (!emotionInput) {
                alert('Please describe your emotions first!');
                return;
            }

            // Show loading
            document.getElementById('aiResult').classList.add('show');
            document.getElementById('aiLoading').style.display = 'flex';
            document.getElementById('aiContent').style.display = 'none';

            try {
                const prompt = buildPromptForGemini(emotionInput, selectedEmotion, currentCreationType);
                const result = await callGeminiAPI(prompt);
                
                // Hide loading and show result
                document.getElementById('aiLoading').style.display = 'none';
                document.getElementById('aiContent').style.display = 'block';
                document.getElementById('aiContent').innerHTML = formatAIResponse(result, currentCreationType);
                
            } catch (error) {
                console.error('Error generating content:', error);
                document.getElementById('aiLoading').style.display = 'none';
                document.getElementById('aiContent').style.display = 'block';
                document.getElementById('aiContent').innerHTML = `
                    <div style="color: var(--error-color); text-align: center;">
                        <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 1rem;"></i>
                        <h3>Unable to generate content</h3>
                        <p>Please check your API configuration and try again.</p>
                    </div>
                `;
            }
        }

        // BUILD CONTEXT-AWARE PROMPTS FOR GEMINI
        function buildPromptForGemini(emotions, mood, type) {
            const baseContext = `You are an AI wellness counselor specialized in creative therapy. The user is feeling: "${emotions}" with a mood of: "${mood}".`;
            
            switch(type) {
                case 'art':
                    return `${baseContext} 
                    
                    Create a detailed art therapy prompt that includes:
                    1. A therapeutic art concept description
                    2. Color palette suggestions based on emotions
                    3. Art techniques that would be healing
                    4. Symbolic elements to include
                    5. Positive affirmations related to the artwork
                    
                    Make it deeply personal and healing-focused. Respond in a warm, encouraging tone.`;
                    
                case 'music':
                    return `${baseContext}
                    
                    Create a personalized music therapy recommendation that includes:
                    1. Musical mood and tempo suggestions
                    2. Instrument combinations that match emotions
                    3. Key signatures and rhythms for healing
                    4. Breathing exercises to do while listening
                    5. Visualization techniques with the music
                    
                    Focus on emotional regulation and healing through sound.`;
                    
                case 'story':
                    return `${baseContext}
                    
                    Create a therapeutic story framework that includes:
                    1. A protagonist facing similar emotional challenges
                    2. A journey of growth and healing
                    3. Positive coping strategies within the narrative
                    4. An uplifting resolution
                    5. Discussion questions for self-reflection
                    
                    Make it relatable, hopeful, and psychologically supportive.`;
                    
                case 'collaboration':
                    return `${baseContext}
                    
                    Help transform negative thoughts into positive creative expressions:
                    1. Identify underlying positive intentions in the emotions
                    2. Suggest creative ways to express these feelings
                    3. Provide reframing techniques for negative thoughts
                    4. Offer collaborative creative exercises
                    5. Include self-compassion practices
                    
                    Focus on empowerment and positive transformation.`;
                    
                default:
                    return `${baseContext} Provide supportive creative therapy guidance.`;
            }
        }

        // GEMINI API CALL FUNCTION
        async function callGeminiAPI(prompt) {
            const requestBody = {
                contents: [{
                    parts: [{
                        text: prompt
                    }]
                }],
                generationConfig: {
                    temperature: 0.7,
                    topK: 40,
                    topP: 0.95,
                    maxOutputTokens: 1024,
                }
            };

            const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestBody)
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            return data.candidates[0].content.parts[0].text;
        }

        // FORMAT AI RESPONSE FOR DISPLAY
        function formatAIResponse(response, type) {
            const iconMap = {
                'art': 'fas fa-palette',
                'music': 'fas fa-music',
                'story': 'fas fa-book',
                'collaboration': 'fas fa-users'
            };

            return `
                <div style="margin-bottom: 1rem;">
                    <h3 style="display: flex; align-items: center; gap: 0.5rem; color: var(--primary-color); margin-bottom: 1rem;">
                        <i class="${iconMap[type]}"></i>
                        AI-Generated ${type.charAt(0).toUpperCase() + type.slice(1)} Therapy
                    </h3>
                    <div style="background: var(--bg-card); padding: 1.5rem; border-radius: var(--radius-sm); border-left: 4px solid var(--success-color); white-space: pre-wrap; line-height: 1.7;">
                        ${response}
                    </div>
                </div>
                <div style="margin-top: 1.5rem; display: flex; gap: 1rem;">
                    <button class="btn btn-primary" onclick="saveToGallery()">
                        <i class="fas fa-save"></i>
                        Save to Gallery
                    </button>
                    <button class="btn btn-secondary" onclick="shareContent()">
                        <i class="fas fa-share"></i>
                        Share
                    </button>
                    <button class="btn btn-secondary" onclick="regenerateContent()">
                        <i class="fas fa-refresh"></i>
                        Regenerate
                    </button>
                </div>
            `;
        }

        // Helper Functions
        function saveDraft() {
            const emotionInput = document.getElementById('emotionInput').value;
            if (emotionInput.trim()) {
                localStorage.setItem(`eirene-draft-${Date.now()}`, JSON.stringify({
                    type: currentCreationType,
                    emotion: emotionInput,
                    mood: selectedEmotion,
                    timestamp: new Date().toISOString()
                }));
                
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> Saved!';
                btn.style.background = 'var(--success-color)';
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                }, 2000);
            }
        }

        function saveToGallery() {
            alert('Content saved to your gallery! (Feature would save to database in production)');
        }

        function shareContent() {
            if (navigator.share) {
                navigator.share({
                    title: 'My Creative Therapy Session',
                    text: 'Check out my AI-generated creative therapy content from Eirene!',
                    url: window.location.href
                });
            } else {
                alert('Sharing feature would be implemented here!');
            }
        }

        function regenerateContent() {
            generateContent();
        }

        // Smooth Scroll Progress Bar
        function updateScrollProgress() {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollPercent = Math.min((scrollTop / docHeight) * 100, 100);
            document.getElementById('scrollProgress').style.width = scrollPercent + '%';
        }

        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        const themeIcon = themeToggle.querySelector('i');

        const savedTheme = localStorage.getItem('eirene-theme') || 'light';
        if (savedTheme === 'dark') {
            body.setAttribute('data-theme', 'dark');
            themeIcon.className = 'fas fa-sun';
        }

        themeToggle.addEventListener('click', () => {
            const currentTheme = body.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                body.removeAttribute('data-theme');
                themeIcon.className = 'fas fa-moon';
                localStorage.setItem('eirene-theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.className = 'fas fa-sun';
                localStorage.setItem('eirene-theme', 'dark');
            }
        });

        // Scroll Effects
        const header = document.getElementById('header');
        const scrollTop = document.getElementById('scrollTop');
        let ticking = false;

        function updateScrollEffects() {
            updateScrollProgress();
            
            if (window.scrollY > 100) {
                header.classList.add('scrolled');
                scrollTop.classList.add('show');
            } else {
                header.classList.remove('scrolled');
                scrollTop.classList.remove('show');
            }
            ticking = false;
        }

        window.addEventListener('scroll', () => {
            if (!ticking) {
                requestAnimationFrame(updateScrollEffects);
                ticking = true;
            }
        });

        scrollTop.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Auto-save functionality
        let autoSaveInterval;
        document.getElementById('emotionInput').addEventListener('input', () => {
            clearTimeout(autoSaveInterval);
            autoSaveInterval = setTimeout(() => {
                const content = document.getElementById('emotionInput').value;
                if (content.trim()) {
                    localStorage.setItem('eirene-current-draft', content);
                }
            }, 2000);
        });

        // Load saved draft on page load
        window.addEventListener('load', () => {
            const savedDraft = localStorage.getItem('eirene-current-draft');
            if (savedDraft) {
                document.getElementById('emotionInput').value = savedDraft;
            }
        });

        console.log('🎨 Enhanced Creative Studio with 3D visualization ready!');
    </script>
</body>
</html>
