<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood Tracker - Eirene AI Wellness</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            /* Premium Color Palette */
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --accent-color: #f093fb;
            --accent-2: #f5576c;
            --accent-3: #4facfe;
            --success-color: #00d4aa;
            --warning-color: #ffb946;
            --error-color: #ff6b6b;
            
            /* Sophisticated Text Colors */
            --text-primary: #1a1a2e;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --text-light: #cbd5e0;
            
            /* Modern Background System */
            --bg-primary: #fafbfc;
            --bg-secondary: #f7f9fc;
            --bg-tertiary: #eef2f7;
            --bg-card: #ffffff;
            --bg-glass: rgba(255, 255, 255, 0.25);
            
            /* Border & Shadow System */
            --border-color: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --shadow-glow: 0 0 40px rgba(102, 126, 234, 0.15);
            
            /* Premium Gradients */
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-tertiary: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-success: linear-gradient(135deg, #00d4aa 0%, #01a085 100%);
            --gradient-glass: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.6) 100%);
            
            /* Modern Border Radius */
            --radius-xs: 8px;
            --radius-sm: 12px;
            --radius-md: 16px;
            --radius-lg: 24px;
            --radius-xl: 32px;
            --radius-full: 9999px;
        }

        [data-theme="dark"] {
            --text-primary: #f7fafc;
            --text-secondary: #e2e8f0;
            --text-muted: #a0aec0;
            --text-light: #718096;
            --bg-primary: #0f0f23;
            --bg-secondary: #16213e;
            --bg-tertiary: #1a2332;
            --bg-card: #1e2a3a;
            --bg-glass: rgba(30, 42, 58, 0.8);
            --border-color: #2d3748;
            --border-light: #4a5568;
            --shadow-glow: 0 0 40px rgba(102, 126, 234, 0.3);
        }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-x: hidden;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            position: relative;
        }

        /* Relaxing Background Animations */
        .wellness-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* Gentle Floating Orbs */
        .floating-orb {
            position: absolute;
            border-radius: 50%;
            opacity: 0.4;
            animation: gentleFloat 12s infinite ease-in-out;
        }

        .floating-orb:nth-child(1) {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.08), rgba(102, 126, 234, 0.02));
            top: 15%;
            left: 10%;
            animation-delay: 0s;
            animation-duration: 15s;
        }

        .floating-orb:nth-child(2) {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, rgba(240, 147, 251, 0.08), rgba(240, 147, 251, 0.02));
            top: 60%;
            right: 15%;
            animation-delay: -3s;
            animation-duration: 18s;
        }

        .floating-orb:nth-child(3) {
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(79, 172, 254, 0.06), rgba(79, 172, 254, 0.02));
            bottom: 25%;
            left: 70%;
            animation-delay: -7s;
            animation-duration: 20s;
        }

        @keyframes gentleFloat {
            0%, 100% { 
                transform: translateY(0px) translateX(0px) scale(1);
                opacity: 0.4;
            }
            25% { 
                transform: translateY(-20px) translateX(15px) scale(1.05);
                opacity: 0.6;
            }
            50% { 
                transform: translateY(-10px) translateX(-10px) scale(0.95);
                opacity: 0.3;
            }
            75% { 
                transform: translateY(-30px) translateX(20px) scale(1.02);
                opacity: 0.5;
            }
        }

        /* Zen Gradient Overlay */
        .zen-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                rgba(102, 126, 234, 0.02) 0%, 
                transparent 25%, 
                rgba(240, 147, 251, 0.02) 50%, 
                transparent 75%, 
                rgba(79, 172, 254, 0.02) 100%
            );
            animation: zenShift 12s ease-in-out infinite;
        }

        @keyframes zenShift {
            0%, 100% { opacity: 0.8; }
            33% { opacity: 0.4; }
            66% { opacity: 0.9; }
        }

        .selectable, input, textarea, .mood-input {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        /* Enhanced Scroll Progress Bar */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 3px;
            background: var(--gradient-primary);
            z-index: 10000;
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Premium Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .loading-screen.hide {
            opacity: 0;
            visibility: hidden;
            transform: scale(1.1);
        }

        .loader {
            width: 80px;
            height: 80px;
            border: 4px solid rgba(255, 255, 255, 0.2);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1.5s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            margin-bottom: 2rem;
        }

        .loading-text {
            color: white;
            font-size: 1.3rem;
            font-weight: 600;
            opacity: 0.95;
            animation: pulse 2s ease-in-out infinite;
            letter-spacing: 0.5px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.95; }
            50% { opacity: 0.7; }
        }

        /* Floating Scroll to Top Button */
        .scroll-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            background: var(--gradient-primary);
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 1000;
            box-shadow: var(--shadow-lg);
            font-size: 1.2rem;
        }

        .scroll-top.show {
            opacity: 1;
            visibility: visible;
            animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .scroll-top:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: var(--shadow-xl);
        }

        @keyframes bounceIn {
            0% { opacity: 0; transform: scale(0.3) translateY(100px); }
            50% { opacity: 1; transform: scale(1.05) translateY(-10px); }
            70% { transform: scale(0.95) translateY(5px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }

        /* Modern Glass Header */
        .header {
            background: var(--bg-glass);
            backdrop-filter: blur(30px) saturate(180%);
            border-bottom: 1px solid var(--border-light);
            padding: 1rem 0;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .header.scrolled {
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(40px) saturate(200%);
            padding: 0.8rem 0;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 0.5rem 1rem;
            border-radius: var(--radius-full);
            background: var(--bg-card);
            box-shadow: var(--shadow-sm);
        }

        .logo:hover {
            transform: scale(1.05) translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .logo i {
            font-size: 2rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: rotate 4s ease-in-out infinite;
        }

        @keyframes rotate {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(10deg); }
        }

        .nav-center {
            display: flex;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            padding: 0.4rem;
            box-shadow: var(--shadow-sm);
            backdrop-filter: blur(20px);
        }

        .nav-links {
            display: flex;
            gap: 0.2rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 0.8rem 1.5rem;
            border-radius: var(--radius-full);
            position: relative;
            white-space: nowrap;
            font-size: 0.9rem;
            overflow: hidden;
        }

        .nav-links a.active {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .nav-links a:hover:not(.active) {
            background: var(--bg-secondary);
            color: var(--primary-color);
            transform: translateY(-1px);
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .profile-section {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 0.5rem 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-full);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
        }

        .profile-section:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .profile-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .profile-info {
            display: flex;
            flex-direction: column;
        }

        .profile-name {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .profile-status {
            font-size: 0.75rem;
            color: var(--success-color);
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: var(--success-color);
            border-radius: 50%;
            animation: pulse-dot 2s ease-in-out infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }

        .theme-toggle {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            padding: 0.7rem;
            cursor: pointer;
            color: var(--text-primary);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-sm);
        }

        .theme-toggle:hover {
            background: var(--gradient-primary);
            color: white;
            transform: scale(1.1) rotate(10deg);
            box-shadow: var(--shadow-md);
        }

        .mobile-menu-btn {
            display: none;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            padding: 0.7rem;
            font-size: 1.1rem;
            color: var(--text-primary);
            cursor: pointer;
            width: 44px;
            height: 44px;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-sm);
        }

        /* Advanced Mood Tracker Dashboard */
        .mood-dashboard {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            min-height: 100vh;
            padding-top: 120px;
            position: relative;
            z-index: 1;
        }

        /* Hero Header Section */
        .mood-hero {
            background: var(--gradient-primary);
            color: white;
            padding: 4rem 3rem;
            border-radius: var(--radius-xl);
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-xl);
        }

        .mood-hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 60%);
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
        }

        .mood-hero::after {
            content: '';
            position: absolute;
            bottom: -40%;
            left: -15%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.08) 0%, transparent 60%);
            border-radius: 50%;
            animation: float 10s ease-in-out infinite reverse;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-15px) rotate(120deg); }
            66% { transform: translateY(-8px) rotate(240deg); }
        }

        .hero-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 2rem;
        }

        .hero-text {
            flex: 1;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            animation: fadeInUp 1s cubic-bezier(0.4, 0, 0.2, 1) 0.2s both;
        }

        .hero-subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 1.5rem;
            animation: fadeInUp 1s cubic-bezier(0.4, 0, 0.2, 1) 0.4s both;
        }

        .hero-stats {
            display: flex;
            gap: 2rem;
            animation: fadeInUp 1s cubic-bezier(0.4, 0, 0.2, 1) 0.6s both;
        }

        .hero-stat {
            text-align: center;
        }

        .hero-stat-number {
            font-size: 2rem;
            font-weight: 700;
            display: block;
        }

        .hero-stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .hero-visual {
            flex: 0 0 300px;
            height: 280px;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* 3D Mood Visualization Container */
        .three-mood-container {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: inset 0 0 30px rgba(255, 255, 255, 0.2);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .three-mood-container canvas {
            width: 100% !important;
            height: 100% !important;
            border-radius: 50%;
        }

        /* Advanced Mood Analysis Section */
        .analysis-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin-bottom: 4rem;
        }

        .analysis-card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: 0;
            box-shadow: var(--shadow-sm);
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) both;
            transition: all 0.4s ease;
            overflow: hidden;
            border: 1px solid var(--border-light);
        }

        .analysis-card:nth-child(1) { animation-delay: 0.1s; }
        .analysis-card:nth-child(2) { animation-delay: 0.2s; }

        .analysis-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-xl);
        }

        .analysis-header {
            background: var(--gradient-primary);
            padding: 2rem;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .analysis-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 150px;
            height: 150px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        .analysis-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 2;
        }

        .analysis-desc {
            opacity: 0.9;
            position: relative;
            z-index: 2;
        }

        .analysis-content {
            padding: 2.5rem;
        }

        /* Smart Text Input */
        .smart-input {
            position: relative;
            margin-bottom: 2rem;
        }

        .mood-input {
            width: 100%;
            min-height: 140px;
            padding: 1.5rem;
            border: 2px solid var(--border-light);
            border-radius: var(--radius-lg);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
            resize: none;
            outline: none;
        }

        .mood-input:focus {
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }

        .mood-input::placeholder {
            color: var(--text-muted);
            opacity: 0.7;
        }

        .input-counter {
            position: absolute;
            bottom: 15px;
            right: 15px;
            font-size: 0.8rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 0.3rem 0.8rem;
            border-radius: var(--radius-full);
            border: 1px solid var(--border-light);
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            font-size: 0.9rem;
            margin-top: 1rem;
        }

        .typing-indicator.show {
            display: flex;
        }

        .typing-dots {
            display: flex;
            gap: 0.3rem;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: var(--primary-color);
            border-radius: 50%;
            animation: typingDot 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingDot {
            0%, 60%, 100% { transform: scale(1); opacity: 0.5; }
            30% { transform: scale(1.3); opacity: 1; }
        }

        /* Advanced Voice Recorder */
        .voice-section {
            text-align: center;
            padding: 1rem 0;
        }

        .voice-visualizer {
            width: 100%;
            height: 120px;
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            border: 2px solid var(--border-light);
        }

        .voice-waves {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            gap: 3px;
        }

        .voice-wave {
            width: 4px;
            background: var(--gradient-primary);
            border-radius: var(--radius-full);
            transition: all 0.1s ease;
            height: 20%;
        }

        .voice-wave.active {
            animation: waveAnimation 0.5s ease-in-out infinite;
        }

        @keyframes waveAnimation {
            0%, 100% { height: 20%; }
            50% { height: 80%; }
        }

        .voice-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .voice-btn {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: none;
            background: var(--gradient-primary);
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
        }

        .voice-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 50%;
            transform: scale(0);
            transition: transform 0.3s ease;
            opacity: 0.2;
        }

        .voice-btn:hover::before {
            transform: scale(1);
        }

        .voice-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-glow);
        }

        .voice-btn.recording {
            background: var(--error-color);
            animation: recordingPulse 1s infinite;
        }

        @keyframes recordingPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.4); }
            50% { box-shadow: 0 0 0 20px rgba(255, 107, 107, 0); }
        }

        .voice-status {
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        /* Real-time Mood Display */
        .live-mood {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: 3rem;
            margin-bottom: 3rem;
            box-shadow: var(--shadow-sm);
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.3s both;
            transition: all 0.3s ease;
            border: 1px solid var(--border-light);
            text-align: center;
        }

        .live-mood:hover {
            box-shadow: var(--shadow-md);
        }

        .mood-display {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 2rem;
        }

        .mood-emoji {
            font-size: 5rem;
            animation: emojiFloat 3s ease-in-out infinite;
        }

        @keyframes emojiFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .mood-info {
            flex: 1;
            text-align: center;
        }

        .current-mood {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .mood-confidence {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .mood-description {
            font-size: 1.1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        /* Interactive Mood Scale */
        .mood-scale-section {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: 3rem;
            margin-bottom: 3rem;
            box-shadow: var(--shadow-sm);
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.4s both;
            border: 1px solid var(--border-light);
        }

        .scale-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .scale-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .scale-subtitle {
            color: var(--text-secondary);
        }

        .mood-scale {
            position: relative;
            height: 60px;
            background: linear-gradient(90deg, 
                #ff6b6b 0%, 
                #ffb946 20%, 
                #eab308 40%, 
                #84cc16 60%, 
                #00d4aa 80%, 
                #4facfe 100%
            );
            border-radius: var(--radius-full);
            margin: 2rem 0;
            cursor: pointer;
            box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .mood-indicator {
            position: absolute;
            top: -15px;
            width: 30px;
            height: 90px;
            background: white;
            border: 4px solid var(--primary-color);
            border-radius: var(--radius-md);
            cursor: grab;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            left: 50%;
            transform: translateX(-50%);
            box-shadow: var(--shadow-lg);
        }

        .mood-indicator:hover {
            transform: translateX(-50%) scale(1.1);
            box-shadow: var(--shadow-xl);
        }

        .mood-indicator.dragging {
            cursor: grabbing;
            transform: translateX(-50%) scale(1.2);
        }

        .scale-labels {
            display: flex;
            justify-content: space-between;
            margin: 1rem 0 2rem;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .mood-feedback {
            text-align: center;
            padding: 1.5rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            margin-top: 2rem;
        }

        /* Advanced Analytics */
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .analytics-card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) both;
            transition: all 0.4s ease;
            border: 1px solid var(--border-light);
        }

        .analytics-card:nth-child(1) { animation-delay: 0.5s; }
        .analytics-card:nth-child(2) { animation-delay: 0.6s; }
        .analytics-card:nth-child(3) { animation-delay: 0.7s; }

        .analytics-card:hover {
            transform: translateY(-6px);
            box-shadow: var(--shadow-lg);
        }

        .analytics-header {
            padding: 2rem;
            background: var(--gradient-tertiary);
            color: white;
            position: relative;
        }

        .analytics-card:nth-child(2) .analytics-header {
            background: var(--gradient-secondary);
        }

        .analytics-card:nth-child(3) .analytics-header {
            background: var(--gradient-success);
        }

        .analytics-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .analytics-title {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .analytics-content {
            padding: 2rem;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-light);
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .metric-value {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 1.1rem;
        }

        /* Smart Insights */
        .insights-section {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: 3rem;
            box-shadow: var(--shadow-sm);
            animation: slideInUp 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.8s both;
            border: 1px solid var(--border-light);
        }

        .insights-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .insights-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .insights-subtitle {
            color: var(--text-secondary);
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }

        .insight-item {
            padding: 2rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-lg);
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 4px solid transparent;
        }

        .insight-item:hover {
            transform: translateY(-4px);
            background: var(--bg-card);
            box-shadow: var(--shadow-sm);
        }

        .insight-item.positive {
            border-left-color: var(--success-color);
        }

        .insight-item.warning {
            border-left-color: var(--warning-color);
        }

        .insight-item.info {
            border-left-color: var(--accent-3);
        }

        .insight-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .insight-item.positive .insight-icon {
            background: var(--success-color);
        }

        .insight-item.warning .insight-icon {
            background: var(--warning-color);
        }

        .insight-item.info .insight-icon {
            background: var(--accent-3);
        }

        .insight-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .insight-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Enhanced Animations */
        @keyframes slideInUp {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes fadeInUp {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Mobile Responsive Design */
        @media (max-width: 968px) {
            .analysis-section {
                grid-template-columns: 1fr;
                gap: 2rem;
            }

            .hero-content {
                flex-direction: column;
                text-align: center;
            }

            .hero-visual {
                flex: none;
                height: 250px;
            }
        }

        @media (max-width: 768px) {
            .nav-center {
                display: none;
            }

            .mobile-menu-btn {
                display: flex;
            }

            .profile-info {
                display: none;
            }

            .mood-dashboard {
                padding: 1rem;
                padding-top: 100px;
            }

            .mood-hero {
                padding: 2rem 1.5rem;
                border-radius: var(--radius-lg);
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-stats {
                flex-direction: column;
                gap: 1rem;
            }

            .analytics-grid {
                grid-template-columns: 1fr;
            }

            .insights-grid {
                grid-template-columns: 1fr;
            }

            /* Mobile Optimization for Animations */
            .floating-orb {
                display: none;
            }

            .zen-overlay {
                opacity: 0.3;
            }
        }

        @media (max-width: 480px) {
            .nav-container {
                padding: 0 1rem;
            }

            .mood-hero {
                padding: 1.5rem;
            }

            .hero-visual {
                height: 200px;
            }

            .analysis-card, .live-mood, .mood-scale-section, .insights-section {
                margin: 0 -0.5rem;
                border-radius: var(--radius-md);
            }

            .analysis-content, .live-mood, .mood-scale-section, .insights-section {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Relaxing Background Animations -->
    <div class="wellness-background">
        <!-- Gentle Floating Orbs -->
        <div class="floating-orb"></div>
        <div class="floating-orb"></div>
        <div class="floating-orb"></div>
        
        <!-- Zen Gradient Overlay -->
        <div class="zen-overlay"></div>
    </div>

    <!-- Enhanced Scroll Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>

    <!-- Premium Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loader"></div>
        <div class="loading-text">Analyzing your emotional patterns...</div>
    </div>

    <!-- Floating Scroll to Top Button -->
    <button class="scroll-top" id="scrollTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Modern Glass Header -->
    <header class="header" id="header">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <i class="fas fa-lotus"></i>
                Eirene
            </a>
            
            <div class="nav-center">
                <nav class="nav-links">
                    <a href="dashboard.html">Dashboard</a>
                    <a href="creative-studio.html">Creative Studio</a>
                    <a href="mood-tracker.html" class="active">Mood Tracker</a>
                    <a href="counselor.html">AI Counselor</a>
                    <a href="wellness-forecast.html">Wellness Forecast</a>
                    <a href="resources.html">Resources</a>
                </nav>
            </div>

            <div class="nav-right">
                <div class="profile-section" id="profileSection">
                    <div class="profile-avatar">R</div>
                    <div class="profile-info">
                        <div class="profile-name">Riya</div>
                        <div class="profile-status">
                            <div class="status-dot"></div>
                            Online
                        </div>
                    </div>
                </div>
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
            </div>

            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Advanced Mood Tracker Dashboard -->
    <main class="mood-dashboard">
        <!-- Hero Header Section -->
        <section class="mood-hero">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">AI Mood Intelligence</h1>
                    <p class="hero-subtitle">Advanced emotional analysis through text, voice, and behavioral patterns with real-time insights</p>
                    <div class="hero-stats">
                        <div class="hero-stat">
                            <span class="hero-stat-number" id="totalAnalyses">247</span>
                            <span class="hero-stat-label">Analyses</span>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-number" id="accuracyRate">94%</span>
                            <span class="hero-stat-label">Accuracy</span>
                        </div>
                        <div class="hero-stat">
                            <span class="hero-stat-number" id="streakDays">12</span>
                            <span class="hero-stat-label">Day Streak</span>
                        </div>
                    </div>
                </div>
                <div class="hero-visual">
                    <div class="three-mood-container" id="threeMoodContainer">
                        <!-- Three.js 3D mood visualization will render here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Advanced Mood Analysis Section -->
        <section class="analysis-section">
            <!-- Smart Text Analysis -->
            <div class="analysis-card">
                <div class="analysis-header">
                    <h3 class="analysis-title">Smart Text Analysis</h3>
                    <p class="analysis-desc">AI analyzes your natural writing style to detect emotional patterns</p>
                </div>
                <div class="analysis-content">
                    <div class="smart-input">
                        <textarea class="mood-input selectable" id="textMoodInput" 
                            placeholder="Write anything... your thoughts, messages, or how you're feeling. I'll analyze the emotional tone and provide insights."></textarea>
                        <div class="input-counter" id="charCounter">0 / 500</div>
                    </div>
                    <div class="typing-indicator" id="typingIndicator">
                        <i class="fas fa-robot"></i>
                        <span>AI is analyzing your text</span>
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advanced Voice Analyzer -->
            <div class="analysis-card">
                <div class="analysis-header" style="background: var(--gradient-secondary);">
                    <h3 class="analysis-title">Voice Emotion Reader</h3>
                    <p class="analysis-desc">Real-time voice analysis for tone, pace, and emotional state</p>
                </div>
                <div class="analysis-content">
                    <div class="voice-section">
                        <div class="voice-visualizer">
                            <div class="voice-waves" id="voiceWaves">
                                <!-- Voice visualization bars will be generated here -->
                            </div>
                        </div>
                        <div class="voice-controls">
                            <button class="voice-btn" id="voiceBtn">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                        <div class="voice-status" id="voiceStatus">Tap to start voice analysis</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Real-time Mood Display -->
        <section class="live-mood">
            <div class="mood-display">
                <div class="mood-emoji" id="moodEmoji">ðŸ˜Š</div>
                <div class="mood-info">
                    <div class="current-mood" id="currentMood">7.2</div>
                    <div class="mood-confidence" id="moodConfidence">87% confidence</div>
                </div>
                <div class="mood-emoji" id="moodTrend">ðŸ“ˆ</div>
            </div>
            <div class="mood-description" id="moodDescription">
                You're feeling positive and optimistic today with steady emotional balance
            </div>
        </section>

        <!-- Interactive Mood Scale -->
        <section class="mood-scale-section">
            <div class="scale-header">
                <h2 class="scale-title">Interactive Mood Scale</h2>
                <p class="scale-subtitle">Drag the indicator or click anywhere on the scale</p>
            </div>
            <div class="mood-scale" id="moodScale">
                <div class="mood-indicator" id="moodIndicator"></div>
            </div>
            <div class="scale-labels">
                <span>Terrible</span>
                <span>Bad</span>
                <span>Okay</span>
                <span>Good</span>
                <span>Great</span>
                <span>Amazing</span>
            </div>
            <div class="mood-feedback" id="moodFeedback">
                <strong>Current Rating: <span id="moodRating">7.2/10</span></strong>
                <p id="feedbackText">You're in a positive headspace with good emotional stability</p>
            </div>
        </section>

        <!-- Advanced Analytics -->
        <section class="analytics-grid">
            <div class="analytics-card">
                <div class="analytics-header">
                    <div class="analytics-icon">ðŸ“Š</div>
                    <h3 class="analytics-title">Behavioral Patterns</h3>
                </div>
                <div class="analytics-content">
                    <div class="metric">
                        <span class="metric-label">Response Speed</span>
                        <span class="metric-value" id="responseSpeed">1.2s avg</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Daily Activity</span>
                        <span class="metric-value" id="dailyActivity">42 min</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Mood Stability</span>
                        <span class="metric-value" id="moodStability">Excellent</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Stress Level</span>
                        <span class="metric-value" id="stressLevel">Low</span>
                    </div>
                </div>
            </div>

            <div class="analytics-card">
                <div class="analytics-header">
                    <div class="analytics-icon">ðŸ§ </div>
                    <h3 class="analytics-title">Emotional Trends</h3>
                </div>
                <div class="analytics-content">
                    <div class="metric">
                        <span class="metric-label">Today vs Yesterday</span>
                        <span class="metric-value" id="dailyChange">+12%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Weekly Average</span>
                        <span class="metric-value" id="weeklyAvg">6.8/10</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Best Time</span>
                        <span class="metric-value" id="bestTime">Evening</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Improvement</span>
                        <span class="metric-value" id="improvement">+23%</span>
                    </div>
                </div>
            </div>

            <div class="analytics-card">
                <div class="analytics-header">
                    <div class="analytics-icon">ðŸ’š</div>
                    <h3 class="analytics-title">Wellness Insights</h3>
                </div>
                <div class="analytics-content">
                    <div class="metric">
                        <span class="metric-label">Positive Ratio</span>
                        <span class="metric-value" id="positiveRatio">73%</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Social Score</span>
                        <span class="metric-value" id="socialScore">8.2/10</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Energy Level</span>
                        <span class="metric-value" id="energyLevel">High</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Sleep Quality</span>
                        <span class="metric-value" id="sleepQuality">Good</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Smart Insights -->
        <section class="insights-section">
            <div class="insights-header">
                <h2 class="insights-title">AI-Powered Insights</h2>
                <p class="insights-subtitle">Personalized recommendations based on your patterns</p>
            </div>
            <div class="insights-grid">
                <div class="insight-item positive">
                    <div class="insight-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h4 class="insight-title">Emotional Stability Excellent</h4>
                    <p class="insight-description">Your mood patterns show remarkable consistency over the past week. This indicates strong emotional regulation skills.</p>
                </div>

                <div class="insight-item warning">
                    <div class="insight-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <h4 class="insight-title">Study Stress Detected</h4>
                    <p class="insight-description">Increased stress patterns during evening hours. Consider implementing relaxation techniques before bedtime.</p>
                </div>

                <div class="insight-item info">
                    <div class="insight-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <h4 class="insight-title">Creative Activities Boost</h4>
                    <p class="insight-description">Your mood improves by 15% after creative sessions. Try scheduling more artistic activities.</p>
                </div>

                <div class="insight-item positive">
                    <div class="insight-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h4 class="insight-title">Social Connection Strong</h4>
                    <p class="insight-description">Regular interactions with friends correlate with your highest mood scores. Maintain those connections!</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Three.js Local File -->
    <script src="./three.js"></script>

    <script>
        // Global Three.js Variables for Mood Visualization
        let scene, camera, renderer, moodSphere, particles, ambientLight;
        let mouseX = 0, mouseY = 0;
        let targetRotationX = 0, targetRotationY = 0;
        let isThreeInitialized = false;
        let currentMoodScore = 7.2;

        // Global state
        let isRecording = false;
        let isDragging = false;
        let mediaRecorder;
        let audioChunks = [];

        // Enhanced Loading Screen
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hide');
                init3DMoodVisualization();
                initializeVoiceVisualizer();
                loadUserData();
            }, 2000);
        });

        // Initialize Three.js 3D Mood Visualization
        function init3DMoodVisualization() {
            console.log('Starting 3D mood visualization...');
            
            // Check if THREE is available
            if (typeof THREE === 'undefined') {
                console.error('THREE.js not loaded! Using fallback...');
                showMoodFallback();
                return;
            }
            
            const container = document.getElementById('threeMoodContainer');
            if (!container) {
                console.error('Container not found!');
                return;
            }
            
            console.log('Container dimensions:', {
                width: container.clientWidth,
                height: container.clientHeight
            });
            
            try {
                // Scene setup
                scene = new THREE.Scene();
                
                // Camera with container aspect ratio
                const containerWidth = container.clientWidth || 300;
                const containerHeight = container.clientHeight || 280;
                
                camera = new THREE.PerspectiveCamera(
                    70, 
                    containerWidth / containerHeight, 
                    0.1, 
                    100
                );
                camera.position.z = 3;
                
                // Renderer setup for R150
                renderer = new THREE.WebGLRenderer({ 
                    antialias: true, 
                    alpha: true,
                    powerPreference: "high-performance"
                });
                
                renderer.setSize(containerWidth, containerHeight);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
                renderer.setClearColor(0x000000, 0);
                
                // Clear container and add canvas
                container.innerHTML = '';
                container.appendChild(renderer.domElement);
                
                console.log('3D Mood renderer created');

                // Lighting - Emotional and Dynamic
                ambientLight = new THREE.AmbientLight(0x667eea, 0.4);
                scene.add(ambientLight);

                const directionalLight = new THREE.DirectionalLight(0x4facfe, 1.0);
                directionalLight.position.set(3, 3, 3);
                scene.add(directionalLight);

                const pointLight = new THREE.PointLight(0xf093fb, 0.8, 10);
                pointLight.position.set(-2, 2, 2);
                scene.add(pointLight);

                // Main Mood Sphere - Responds to Emotional State
                const sphereGeometry = new THREE.SphereGeometry(1.2, 32, 32);
                const sphereMaterial = new THREE.MeshStandardMaterial({
                    color: 0x667eea,
                    metalness: 0.7,
                    roughness: 0.3,
                    emissive: 0x221144,
                    emissiveIntensity: 0.3,
                    transparent: true,
                    opacity: 0.85
                });

                moodSphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
                scene.add(moodSphere);

                console.log('Mood sphere added to scene');

                // Add Emotional Particles
                createEmotionalParticles();

                // Mouse interaction
                container.addEventListener('mousemove', onMoodMouseMove, false);
                container.addEventListener('mouseleave', onMoodMouseLeave, false);

                // Resize handler
                window.addEventListener('resize', onMoodWindowResize, false);

                // Mark as initialized and start animation
                isThreeInitialized = true;
                animate3DMood();
                
                console.log('3D mood visualization initialized successfully!');
                
            } catch (error) {
                console.error('Three.js mood visualization error:', error);
                showMoodFallback();
            }
        }

        function createEmotionalParticles() {
            if (!scene) return;
            
            try {
                const particleCount = 50;
                const particlesGeometry = new THREE.BufferGeometry();
                const positions = new Float32Array(particleCount * 3);
                const colors = new Float32Array(particleCount * 3);
                
                for (let i = 0; i < particleCount; i++) {
                    // Position particles in a sphere around the mood sphere
                    const radius = 2 + Math.random() * 1;
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.random() * Math.PI;
                    
                    positions[i * 3] = radius * Math.sin(phi) * Math.cos(theta);
                    positions[i * 3 + 1] = radius * Math.sin(phi) * Math.sin(theta);
                    positions[i * 3 + 2] = radius * Math.cos(phi);
                    
                    // Emotional colors
                    const colorVariation = Math.random();
                    if (colorVariation < 0.33) {
                        // Blue tones - calm
                        colors[i * 3] = 0.3 + Math.random() * 0.2;     // R
                        colors[i * 3 + 1] = 0.5 + Math.random() * 0.3; // G  
                        colors[i * 3 + 2] = 0.8 + Math.random() * 0.2; // B
                    } else if (colorVariation < 0.66) {
                        // Purple tones - creative
                        colors[i * 3] = 0.6 + Math.random() * 0.3;     // R
                        colors[i * 3 + 1] = 0.2 + Math.random() * 0.3; // G
                        colors[i * 3 + 2] = 0.8 + Math.random() * 0.2; // B
                    } else {
                        // Pink tones - happy
                        colors[i * 3] = 0.8 + Math.random() * 0.2;     // R
                        colors[i * 3 + 1] = 0.4 + Math.random() * 0.3; // G
                        colors[i * 3 + 2] = 0.7 + Math.random() * 0.3; // B
                    }
                }
                
                particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
                particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
                
                const particlesMaterial = new THREE.PointsMaterial({
                    size: 0.05,
                    transparent: true,
                    opacity: 0.6,
                    vertexColors: true,
                    blending: THREE.AdditiveBlending
                });
                
                particles = new THREE.Points(particlesGeometry, particlesMaterial);
                scene.add(particles);
                
                console.log('Emotional particles added');
            } catch (error) {
                console.error('Error creating emotional particles:', error);
            }
        }

        function onMoodMouseMove(event) {
            if (!isThreeInitialized) return;
            
            const container = document.getElementById('threeMoodContainer');
            const rect = container.getBoundingClientRect();
            
            mouseX = ((event.clientX - rect.left) / container.clientWidth) * 2 - 1;
            mouseY = -((event.clientY - rect.top) / container.clientHeight) * 2 + 1;
            
            targetRotationX = mouseY * 0.4;
            targetRotationY = mouseX * 0.4;
        }

        function onMoodMouseLeave() {
            targetRotationX = 0;
            targetRotationY = 0;
        }

        function onMoodWindowResize() {
            if (!isThreeInitialized) return;
            
            const container = document.getElementById('threeMoodContainer');
            if (!container || !camera || !renderer) return;
            
            const containerWidth = container.clientWidth || 300;
            const containerHeight = container.clientHeight || 280;
            
            camera.aspect = containerWidth / containerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(containerWidth, containerHeight);
        }

        function animate3DMood() {
            if (!isThreeInitialized) return;
            
            requestAnimationFrame(animate3DMood);

            try {
                if (moodSphere) {
                    // Interactive rotation
                    moodSphere.rotation.x += (targetRotationX - moodSphere.rotation.x) * 0.03;
                    moodSphere.rotation.y += (targetRotationY - moodSphere.rotation.y) * 0.03;
                    
                    // Continuous gentle rotation
                    moodSphere.rotation.x += 0.002;
                    moodSphere.rotation.y += 0.003;
                    
                    // Mood-based pulsing
                    const moodScale = 1 + (currentMoodScore / 10) * 0.2 + Math.sin(Date.now() * 0.002) * 0.1;
                    moodSphere.scale.setScalar(moodScale);
                    
                    // Color changes based on mood
                    updateMoodSphereColor(currentMoodScore);
                }

                if (particles) {
                    particles.rotation.y += 0.001;
                    particles.rotation.x += 0.0005;
                    
                    // Gentle particle movement based on mood
                    const positions = particles.geometry.attributes.position.array;
                    const time = Date.now() * 0.001;
                    
                    for (let i = 0; i < positions.length; i += 3) {
                        const originalX = positions[i];
                        const originalY = positions[i + 1];
                        const originalZ = positions[i + 2];
                        
                        positions[i] += Math.sin(time + originalX) * 0.005;
                        positions[i + 1] += Math.cos(time + originalY) * 0.005;
                        positions[i + 2] += Math.sin(time * 0.5 + originalZ) * 0.003;
                    }
                    particles.geometry.attributes.position.needsUpdate = true;
                }

                if (ambientLight) {
                    // Mood-based ambient light intensity
                    const lightIntensity = 0.3 + (currentMoodScore / 10) * 0.4;
                    ambientLight.intensity = lightIntensity;
                }

                if (renderer && scene && camera) {
                    renderer.render(scene, camera);
                }
            } catch (error) {
                console.error('3D mood animation error:', error);
                isThreeInitialized = false;
            }
        }

        function updateMoodSphereColor(moodScore) {
            if (!moodSphere) return;
            
            // Color mapping based on mood score (0-10)
            let color, emissiveColor;
            
            if (moodScore >= 8) {
                // Happy - Bright blue/purple
                color = new THREE.Color().setHSL(0.7, 0.8, 0.6);
                emissiveColor = new THREE.Color().setHSL(0.7, 0.6, 0.3);
            } else if (moodScore >= 6) {
                // Good - Cool blue
                color = new THREE.Color().setHSL(0.6, 0.7, 0.5);
                emissiveColor = new THREE.Color().setHSL(0.6, 0.5, 0.2);
            } else if (moodScore >= 4) {
                // Neutral - Purple/pink
                color = new THREE.Color().setHSL(0.8, 0.6, 0.5);
                emissiveColor = new THREE.Color().setHSL(0.8, 0.4, 0.2);
            } else if (moodScore >= 2) {
                // Low - Orange/red
                color = new THREE.Color().setHSL(0.1, 0.7, 0.5);
                emissiveColor = new THREE.Color().setHSL(0.1, 0.5, 0.2);
            } else {
                // Very low - Red
                color = new THREE.Color().setHSL(0.0, 0.8, 0.4);
                emissiveColor = new THREE.Color().setHSL(0.0, 0.6, 0.2);
            }
            
            moodSphere.material.color = color;
            moodSphere.material.emissive = emissiveColor;
        }

        // Fallback visualization if Three.js fails
        function showMoodFallback() {
            const container = document.getElementById('threeMoodContainer');
            if (!container) return;
            
            container.innerHTML = `
                <div style="
                    width: 100%;
                    height: 100%;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    background: linear-gradient(135deg, #667eea, #764ba2);
                    border-radius: 50%;
                    color: white;
                    text-align: center;
                ">
                    <div style="
                        width: 150px;
                        height: 150px;
                        background: rgba(255,255,255,0.2);
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 4rem;
                        margin-bottom: 1rem;
                        animation: gentleFloat 3s ease-in-out infinite;
                        border: 4px solid rgba(255,255,255,0.3);
                    ">
                        ðŸŽ­
                    </div>
                    <div style="font-size: 1.1rem; font-weight: 600; opacity: 0.9;">
                        Mood Analysis
                    </div>
                </div>
            `;
            
            console.log('Mood fallback visualization displayed');
        }

        // GEMINI API CONFIGURATION (same as original)
        const GEMINI_API_KEY = 'YOUR_GEMINI_API_KEY_HERE';
        const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent';

        // Initialize voice visualizer bars
        function initializeVoiceVisualizer() {
            const voiceWaves = document.getElementById('voiceWaves');
            for (let i = 0; i < 40; i++) {
                const wave = document.createElement('div');
                wave.className = 'voice-wave';
                wave.style.animationDelay = `${i * 0.1}s`;
                voiceWaves.appendChild(wave);
            }
        }

        // Load user data from localStorage
        function loadUserData() {
            const userData = JSON.parse(localStorage.getItem('eirene-mood-data') || '{}');
            
            // Update stats
            document.getElementById('totalAnalyses').textContent = userData.totalAnalyses || 247;
            document.getElementById('streakDays').textContent = userData.streakDays || 12;
            
            // Load mood history
            const moodHistory = JSON.parse(localStorage.getItem('eirene-mood-history') || '[]');
            if (moodHistory.length > 0) {
                const latestMood = moodHistory[moodHistory.length - 1];
                updateMoodDisplay(latestMood.moodScore || 7.2);
            }
        }

        // Smooth Scroll Progress Bar
        function updateScrollProgress() {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrollPercent = Math.min((scrollTop / docHeight) * 100, 100);
            document.getElementById('scrollProgress').style.width = scrollPercent + '%';
        }

        // Enhanced Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        const themeIcon = themeToggle.querySelector('i');

        const savedTheme = localStorage.getItem('eirene-theme') || 'light';
        if (savedTheme === 'dark') {
            body.setAttribute('data-theme', 'dark');
            themeIcon.className = 'fas fa-sun';
        }

        themeToggle.addEventListener('click', () => {
            const currentTheme = body.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                body.removeAttribute('data-theme');
                themeIcon.className = 'fas fa-moon';
                localStorage.setItem('eirene-theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                themeIcon.className = 'fas fa-sun';
                localStorage.setItem('eirene-theme', 'dark');
            }
        });

        // Ultra Smooth Scroll Effects
        const header = document.getElementById('header');
        const scrollTop = document.getElementById('scrollTop');
        let ticking = false;

        function updateScrollEffects() {
            updateScrollProgress();
            
            if (window.scrollY > 100) {
                header.classList.add('scrolled');
                scrollTop.classList.add('show');
            } else {
                header.classList.remove('scrolled');
                scrollTop.classList.remove('show');
            }
            ticking = false;
        }

        window.addEventListener('scroll', () => {
            if (!ticking) {
                requestAnimationFrame(updateScrollEffects);
                ticking = true;
            }
        });

        scrollTop.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // ADVANCED TEXT ANALYSIS WITH GEMINI (same as original)
        const textInput = document.getElementById('textMoodInput');
        const charCounter = document.getElementById('charCounter');
        const typingIndicator = document.getElementById('typingIndicator');
        let analysisTimeout;

        textInput.addEventListener('input', () => {
            const length = textInput.value.length;
            charCounter.textContent = `${length} / 500`;
            
            // Update counter color based on length
            if (length > 450) {
                charCounter.style.color = 'var(--error-color)';
            } else if (length > 300) {
                charCounter.style.color = 'var(--warning-color)';
            } else {
                charCounter.style.color = 'var(--text-muted)';
            }

            clearTimeout(analysisTimeout);
            if (length > 15) {
                typingIndicator.classList.add('show');
                analysisTimeout = setTimeout(() => {
                    analyzeTextWithGemini(textInput.value);
                }, 2000);
            } else {
                typingIndicator.classList.remove('show');
            }
        });

        async function analyzeTextWithGemini(text) {
            try {
                const prompt = `Analyze this text for emotional content and mood: "${text}"

                Respond ONLY in this JSON format:
                {
                    "emotion": "primary emotion (Happy/Sad/Anxious/Calm/Excited/Angry/Neutral/Optimistic/etc.)",
                    "confidence": 85,
                    "moodScore": 7.5,
                    "description": "Brief analysis in one sentence",
                    "keywords": ["positive", "energetic", "focused"]
                }

                Be accurate and professional.`;

                const result = await callGeminiAPI(prompt);
                const analysis = JSON.parse(result);
                
                updateMoodFromAnalysis(analysis);
                typingIndicator.classList.remove('show');
                
            } catch (error) {
                console.error('Gemini analysis failed:', error);
                fallbackTextAnalysis(text);
                typingIndicator.classList.remove('show');
            }
        }

        // GEMINI API CALL FUNCTION (same as original)
        async function callGeminiAPI(prompt) {
            const requestBody = {
                contents: [{
                    parts: [{
                        text: prompt
                    }]
                }],
                generationConfig: {
                    temperature: 0.2,
                    topK: 10,
                    topP: 0.8,
                    maxOutputTokens: 200,
                }
            };

            const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestBody)
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            return data.candidates[0].content.parts[0].text;
        }

        // FALLBACK TEXT ANALYSIS (same as original)
        function fallbackTextAnalysis(text) {
            const words = text.toLowerCase();
            let moodScore = 5.0;
            let emotion = 'Neutral';
            let confidence = 75;

            // Advanced keyword analysis
            const emotionKeywords = {
                'happy': ['happy', 'joy', 'excited', 'love', 'amazing', 'wonderful', 'great', 'fantastic'],
                'sad': ['sad', 'depressed', 'down', 'disappointed', 'hurt', 'crying', 'lonely'],
                'anxious': ['anxious', 'worried', 'nervous', 'stressed', 'panic', 'fear', 'scared'],
                'calm': ['calm', 'peaceful', 'relaxed', 'serene', 'tranquil', 'quiet', 'zen'],
                'excited': ['excited', 'thrilled', 'pumped', 'energetic', 'enthusiastic'],
                'angry': ['angry', 'mad', 'furious', 'frustrated', 'irritated', 'annoyed']
            };

            let maxCount = 0;
            let detectedEmotion = 'neutral';

            for (const [key, keywords] of Object.entries(emotionKeywords)) {
                const count = keywords.filter(keyword => words.includes(keyword)).length;
                if (count > maxCount) {
                    maxCount = count;
                    detectedEmotion = key;
                }
            }

            // Calculate mood score
            const emotionScores = {
                'happy': 8.5,
                'excited': 8.0,
                'calm': 7.0,
                'neutral': 5.0,
                'anxious': 3.5,
                'sad': 2.5,
                'angry': 2.0
            };

            emotion = detectedEmotion.charAt(0).toUpperCase() + detectedEmotion.slice(1);
            moodScore = emotionScores[detectedEmotion] || 5.0;
            confidence = Math.min(95, 60 + (maxCount * 10));

            const analysis = {
                emotion: emotion,
                confidence: confidence,
                moodScore: moodScore,
                description: `Analysis based on ${maxCount} emotional indicators`,
                keywords: emotionKeywords[detectedEmotion].slice(0, 3)
            };

            updateMoodFromAnalysis(analysis);
        }

        // UPDATE MOOD FROM ANALYSIS (updated to sync with 3D)
        function updateMoodFromAnalysis(analysis) {
            currentMoodScore = analysis.moodScore;
            
            // Update mood display
            updateMoodDisplay(analysis.moodScore);
            
            // Update confidence
            document.getElementById('moodConfidence').textContent = `${analysis.confidence}% confidence â€¢ ${analysis.emotion}`;
            
            // Update 3D visualization
            if (isThreeInitialized) {
                updateMoodSphereColor(currentMoodScore);
            }
            
            // Save analysis
            saveAnalysisData(analysis);
        }

        // Voice recording functions (same as original)
        const voiceBtn = document.getElementById('voiceBtn');
        const voiceStatus = document.getElementById('voiceStatus');

        voiceBtn.addEventListener('click', () => {
            if (!isRecording) {
                startVoiceRecording();
            } else {
                stopVoiceRecording();
            }
        });

        async function startVoiceRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    audio: {
                        echoCancellation: true,
                        noiseSuppression: true,
                        sampleRate: 44100
                    }
                });
                
                mediaRecorder = new MediaRecorder(stream, {
                    mimeType: 'audio/webm'
                });
                
                audioChunks = [];
                
                mediaRecorder.addEventListener('dataavailable', event => {
                    audioChunks.push(event.data);
                });
                
                mediaRecorder.addEventListener('stop', () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    analyzeVoiceData(audioBlob);
                });
                
                mediaRecorder.start();
                isRecording = true;
                
                voiceBtn.classList.add('recording');
                voiceBtn.querySelector('i').className = 'fas fa-stop';
                voiceStatus.textContent = 'Recording... speak naturally for 5-10 seconds';
                
                // Start voice visualization
                startVoiceVisualization();
                
                // Auto-stop after 10 seconds
                setTimeout(() => {
                    if (isRecording) {
                        stopVoiceRecording();
                    }
                }, 10000);
                
            } catch (error) {
                console.error('Microphone access denied:', error);
                voiceStatus.textContent = 'Microphone access required for voice analysis';
            }
        }

        function stopVoiceRecording() {
            if (mediaRecorder && isRecording) {
                mediaRecorder.stop();
                mediaRecorder.stream.getTracks().forEach(track => track.stop());
            }
            
            isRecording = false;
            voiceBtn.classList.remove('recording');
            voiceBtn.querySelector('i').className = 'fas fa-microphone';
            voiceStatus.textContent = 'Processing voice analysis...';
            
            stopVoiceVisualization();
        }

        function startVoiceVisualization() {
            const waves = document.querySelectorAll('.voice-wave');
            waves.forEach(wave => wave.classList.add('active'));
        }

        function stopVoiceVisualization() {
            const waves = document.querySelectorAll('.voice-wave');
            waves.forEach(wave => wave.classList.remove('active'));
        }

        function analyzeVoiceData(audioBlob) {
            // Simulate voice analysis (in production, you'd send to speech-to-text API)
            setTimeout(() => {
                const voiceEmotions = [
                    { emotion: 'Calm', confidence: 89, moodScore: 7.2, description: 'Steady pace with clear articulation' },
                    { emotion: 'Energetic', confidence: 92, moodScore: 8.1, description: 'Upbeat tone with faster pace' },
                    { emotion: 'Thoughtful', confidence: 85, moodScore: 6.8, description: 'Measured speech with deliberate pauses' },
                    { emotion: 'Confident', confidence: 88, moodScore: 7.9, description: 'Strong voice with good rhythm' }
                ];

                const randomAnalysis = voiceEmotions[Math.floor(Math.random() * voiceEmotions.length)];
                updateMoodFromAnalysis(randomAnalysis);
                
                voiceStatus.textContent = `Voice Analysis: ${randomAnalysis.emotion} (${randomAnalysis.confidence}% confidence)`;
                
                setTimeout(() => {
                    voiceStatus.textContent = 'Tap to start voice analysis';
                }, 5000);
                
            }, 2000);
        }

        // INTERACTIVE MOOD SCALE (same as original but updates 3D)
        const moodScale = document.getElementById('moodScale');
        const moodIndicator = document.getElementById('moodIndicator');
        const moodRating = document.getElementById('moodRating');
        const feedbackText = document.getElementById('feedbackText');

        // Initialize mood scale
        updateMoodDisplay(currentMoodScore);

        // Click handler for mood scale
        moodScale.addEventListener('click', (e) => {
            if (!isDragging) {
                const rect = moodScale.getBoundingClientRect();
                const percentage = (e.clientX - rect.left) / rect.width;
                const newMood = Math.round((percentage * 10) * 10) / 10;
                const clampedMood = Math.max(0, Math.min(10, newMood));
                
                updateMoodDisplay(clampedMood);
                currentMoodScore = clampedMood;
                
                // Update 3D visualization
                if (isThreeInitialized) {
                    updateMoodSphereColor(currentMoodScore);
                }
            }
        });

        // Drag functionality for mood indicator
        let startX = 0;
        let startLeft = 0;

        moodIndicator.addEventListener('mousedown', (e) => {
            isDragging = true;
            startX = e.clientX;
            const rect = moodScale.getBoundingClientRect();
            startLeft = moodIndicator.offsetLeft;
            moodIndicator.classList.add('dragging');
            
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
        });

        function onMouseMove(e) {
            if (!isDragging) return;
            
            const deltaX = e.clientX - startX;
            const scaleRect = moodScale.getBoundingClientRect();
            const newLeft = startLeft + deltaX;
            const percentage = newLeft / scaleRect.width;
            const clampedPercentage = Math.max(0, Math.min(1, percentage));
            
            const newMood = Math.round((clampedPercentage * 10) * 10) / 10;
            updateMoodDisplay(newMood);
            currentMoodScore = newMood;
            
            // Update 3D visualization in real-time
            if (isThreeInitialized) {
                updateMoodSphereColor(currentMoodScore);
            }
        }

        function onMouseUp() {
            isDragging = false;
            moodIndicator.classList.remove('dragging');
            
            document.removeEventListener('mousemove', onMouseMove);
            document.removeEventListener('mouseup', onMouseUp);
        }

        // UPDATE MOOD DISPLAY (same as original)
        function updateMoodDisplay(mood) {
            const percentage = (mood / 10) * 100;
            moodIndicator.style.left = `${percentage}%`;
            
            // Update main mood display
            document.getElementById('currentMood').textContent = mood.toFixed(1);
            moodRating.textContent = `${mood.toFixed(1)}/10`;
            
            // Update emoji based on mood
            const moodEmoji = document.getElementById('moodEmoji');
            const moodTrend = document.getElementById('moodTrend');
            
            if (mood >= 8.5) {
                moodEmoji.textContent = 'ðŸ¤©';
                moodTrend.textContent = 'ðŸš€';
            } else if (mood >= 7.5) {
                moodEmoji.textContent = 'ðŸ˜Š';
                moodTrend.textContent = 'ðŸ“ˆ';
            } else if (mood >= 6.5) {
                moodEmoji.textContent = 'ðŸ™‚';
                moodTrend.textContent = 'âž¡ï¸';
            } else if (mood >= 5.5) {
                moodEmoji.textContent = 'ðŸ˜';
                moodTrend.textContent = 'âž¡ï¸';
            } else if (mood >= 4.0) {
                moodEmoji.textContent = 'ðŸ˜”';
                moodTrend.textContent = 'ðŸ“‰';
            } else {
                moodEmoji.textContent = 'ðŸ˜¢';
                moodTrend.textContent = 'â¬‡ï¸';
            }
            
            // Update description
            const descriptions = {
                9: "You're feeling absolutely amazing! Everything seems to be going perfectly.",
                8: "You're in an excellent mood with high energy and positivity.",
                7: "You're feeling good with a positive outlook and stable emotions.",
                6: "You're doing well with a generally positive mindset.",
                5: "You're feeling neutral - balanced but could use a little boost.",
                4: "You're having a slightly difficult time but nothing too concerning.",
                3: "You're struggling today - consider reaching out for support.",
                2: "You're having a tough time - let's focus on small positive steps.",
                1: "You're feeling very low - please consider professional support."
            };
            
            const moodKey = Math.round(mood);
            const description = descriptions[moodKey] || descriptions[5];
            document.getElementById('moodDescription').textContent = description;
            feedbackText.textContent = description;
        }

        // Rest of the functions remain the same as the original...
        // (saveAnalysisData, isConsecutiveDay, updateAnalytics, etc.)

        // SAVE ANALYSIS DATA (same as original)
        function saveAnalysisData(analysis) {
            const timestamp = new Date().toISOString();
            const moodData = {
                timestamp,
                moodScore: analysis.moodScore,
                emotion: analysis.emotion,
                confidence: analysis.confidence,
                description: analysis.description
            };
            
            // Save to history
            let history = JSON.parse(localStorage.getItem('eirene-mood-history') || '[]');
            history.push(moodData);
            
            // Keep only last 50 entries
            if (history.length > 50) {
                history = history.slice(-50);
            }
            
            localStorage.setItem('eirene-mood-history', JSON.stringify(history));
            
            // Update user stats
            const userData = JSON.parse(localStorage.getItem('eirene-mood-data') || '{}');
            userData.totalAnalyses = (userData.totalAnalyses || 0) + 1;
            userData.lastUpdate = timestamp;
            
            // Update streak
            const today = new Date().toDateString();
            const lastDate = userData.lastDate;
            
            if (lastDate !== today) {
                if (isConsecutiveDay(lastDate, today)) {
                    userData.streakDays = (userData.streakDays || 0) + 1;
                } else {
                    userData.streakDays = 1;
                }
                userData.lastDate = today;
            }
            
            localStorage.setItem('eirene-mood-data', JSON.stringify(userData));
            
            // Update UI
            document.getElementById('totalAnalyses').textContent = userData.totalAnalyses;
            document.getElementById('streakDays').textContent = userData.streakDays;
        }

        // Helper function to check consecutive days
        function isConsecutiveDay(lastDate, currentDate) {
            if (!lastDate) return false;
            
            const last = new Date(lastDate);
            const current = new Date(currentDate);
            const diffTime = Math.abs(current - last);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            return diffDays === 1;
        }

        // Auto-update analytics
        function updateAnalytics() {
            const history = JSON.parse(localStorage.getItem('eirene-mood-history') || '[]');
            
            if (history.length > 1) {
                const recent = history.slice(-7); // Last 7 entries
                const avgMood = recent.reduce((sum, entry) => sum + entry.moodScore, 0) / recent.length;
                
                document.getElementById('weeklyAvg').textContent = `${avgMood.toFixed(1)}/10`;
                
                // Calculate daily change
                const today = history[history.length - 1]?.moodScore || currentMoodScore;
                const yesterday = history[history.length - 2]?.moodScore || currentMoodScore;
                const change = ((today - yesterday) / yesterday * 100).toFixed(0);
                
                document.getElementById('dailyChange').textContent = `${change > 0 ? '+' : ''}${change}%`;
                
                // Update positive ratio
                const positiveCount = recent.filter(entry => entry.moodScore >= 6).length;
                const positiveRatio = (positiveCount / recent.length * 100).toFixed(0);
                document.getElementById('positiveRatio').textContent = `${positiveRatio}%`;
            }
        }

        // Update analytics on load
        updateAnalytics();
        
        console.log('Advanced Mood Tracker with 3D visualization ready! ðŸŽ­âœ¨');
    </script>
</body>
</html>
